<!DOCTYPE html>          
<html lang="hi">          
<head>          
<meta charset="UTF-8">          
<meta name="viewport" content="width=device-width, initial-scale=1.0">          
<title>‚úÖ ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ü‡§æ‡§∏‡•ç‡§ï ‡§™‡•ç‡§≤‡§æ‡§®‡§∞ (‡§≤‡•ã‡§ï‡§≤ ‡§∞‡•Ä‡§°-‡§ì‡§®‡§≤‡•Ä)</title>          

<style>          
body { font-family:'Poppins', sans-serif; background:#f9fafb; margin:0; padding:1rem; color:#111827; }          
h1 { text-align:center; color:#3730a3; margin-bottom:1rem; }          

/* Input Section - Disabled for read-only mode */          
.task-input-section { display:flex; flex-wrap:wrap; gap:0.5rem; background:#fff; padding:1rem; border-radius:1rem; box-shadow:0 4px 12px rgba(0,0,0,0.1); justify-content:center; opacity: 0.5; pointer-events: none;}          
.task-input-section input { flex:1; min-width:150px; padding:0.8rem; border:2px solid #c7d2fe; border-radius:0.6rem; outline:none; }          
.task-input-section button { background:#4f46e5; color:white; border:none; border-radius:0.6rem; padding:0.8rem 1.6rem; cursor:pointer; font-weight:600; }          

/* Filter */          
.filter-bar { text-align:center; margin:1rem 0; }          
.filter-bar input { padding:0.6rem; border-radius:0.6rem; border:1px solid #c7d2fe; }          

/* Task List */          
.task-list-section { background:#fff; border-radius:1rem; padding:1rem; box-shadow:0 4px 15px rgba(0,0,0,0.1); }          
.date-group { border-top:1px solid #e5e7eb; padding-top:1rem; margin-top:1rem; }          
.date-heading { background:#e0e7ff; color:#3730a3; padding:0.75rem 1rem; border-radius:0.75rem; font-size:1.1rem; font-weight:700; display:flex; justify-content:space-between; align-items:center; cursor:default; user-select:none; }          
.task-item { background:#f9fafb; border-radius:0.5rem; padding:0.5rem 0.75rem; margin:0.5rem 0; border-left:5px solid transparent; }          
.completed { background:#dcfce7 !important; border-left-color:#22c55e !important; color:#166534; }          

/* Read-Only Status */
#loadStatus {
    text-align: center;
    padding: 0.8rem;
    border-radius: 0.6rem;
    font-weight: 600;
    margin-bottom: 1rem;
    background: #fef3c7; 
    color: #a16207;
}

/* Hidden elements for read-only view */
.task-header, .toggle-icon { display: none !important; }

</style>          
</head>          

<body>          

<h1>‚úÖ ‡§ü‡§æ‡§∏‡•ç‡§ï ‡§™‡•ç‡§≤‡§æ‡§®‡§∞ (‡§∞‡•Ä‡§°-‡§ì‡§®‡§≤‡•Ä)</h1>          

<div class="task-input-section">          
  <input id="taskInput" type="text" placeholder="‡§ü‡§æ‡§∏‡•ç‡§ï ‡§≤‡§ø‡§ñ‡•á‡§Ç...">          
  <input id="noteInput" type="text" placeholder="‡§®‡•ã‡§ü (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)">          
  <input id="taskDate" type="date">          
  <button>‚ûï ‡§ú‡•ã‡§°‡§º‡•á‡§Ç (‡§Ö‡§ï‡•ç‡§∑‡§Æ)</button>          
</div>          

<div id="loadStatus">‚è≥ ‡§≤‡•ã‡§ï‡§≤ ‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡•á ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>

<div class="filter-bar">          
  <label>üìÜ ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§∏‡•á ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡§∞‡•á‡§Ç: </label>          
  <input id="filterDate" type="date" onchange="renderTasks()">          
</div>          

<div class="task-list-section">          
  <div id="tasksByDateContainer"></div>          
</div>          

<script>          
/* -------------------------------------------------          
   CONFIG - LOCAL FILE          
-------------------------------------------------- */          
const LOCAL_FILE_NAME = "https://raw.githubusercontent.com/abhir12ram/DailyTaskDb/refs/heads/main/task.json"; 

let allTasks = []; // Holds the tasks loaded from the file
let groupStates = {};           

/* -------------------------------------------------          
   LOCAL JSON DATA LOAD FUNCTION          
-------------------------------------------------- */          
async function loadTasksFromLocalFile() {          
    const statusElement = document.getElementById("loadStatus");
    statusElement.innerHTML = "‚è≥ ‡§≤‡•ã‡§ï‡§≤ ‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡•á ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...";
    statusElement.style.background = '#fef3c7'; // Yellow
    statusElement.style.color = '#a16207';
    
    try {          
        // ‡§≤‡•ã‡§ï‡§≤ ‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡•á ‡§°‡•á‡§ü‡§æ Fetch ‡§ï‡§∞‡•á‡§Ç
        const res = await fetch(LOCAL_FILE_NAME);          
        if (!res.ok) {
            // ‡§Ø‡§¶‡§ø HTTP ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•à (‡§ú‡•à‡§∏‡•á 404), ‡§§‡•ã ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§´‡•á‡§Ç‡§ï‡•á‡§Ç
            throw new Error(`Local file not found or failed to load: ${res.status}`);
        }
        allTasks = await res.json();
        
        // ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§ü‡§æ‡§∏‡•ç‡§ï ‡§è‡§ï ‡§∏‡§∞‡§£‡•Ä (Array) ‡§π‡•à
        if (!Array.isArray(allTasks)) {
             throw new Error("Invalid data format in local file (Expected Array).");
        }
        
        renderTasks();
        
        statusElement.innerHTML = "‚úÖ ‡§ü‡§æ‡§∏‡•ç‡§ï ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§≤‡•ã‡§° ‡§π‡•ã ‡§ó‡§è‡•§ (‡§≤‡•ã‡§ï‡§≤ ‡§´‡§º‡§æ‡§á‡§≤)";
        statusElement.style.background = '#d1fae5'; // Green
        statusElement.style.color = '#065f46';

    } catch (e) {          
        console.error("‚ùå Local Load Error:", e);
        statusElement.innerHTML = `‚ùå ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§æ: ${e.message}`;
        statusElement.style.background = '#fee2e2'; // Red
        statusElement.style.color = '#991b1b';
        document.getElementById("tasksByDateContainer").innerHTML = "<p style='text-align:center; color:red;'>‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§´‡§≤‡•§ ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø **tasks_data.json** ‡§´‡§º‡§æ‡§á‡§≤ ‡§â‡§∏‡•Ä ‡§´‡§º‡•ã‡§≤‡•ç‡§°‡§∞ ‡§Æ‡•á‡§Ç ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à‡•§</p>";
    }          
}          

/* -------------------------          
   RENDER TASKS (Using allTasks array)          
-------------------------- */          
function renderTasks(){          
  const container=document.getElementById("tasksByDateContainer");          
  const filterDate=document.getElementById("filterDate").value;          

  container.innerHTML="";          
  let filtered=allTasks;          

  if(filterDate) filtered=allTasks.filter(t=>t.date===filterDate);          

  if(!filtered.length){          
    container.innerHTML="<p style='text-align:center;color:gray;'>‡§ï‡•ã‡§à ‡§ü‡§æ‡§∏‡•ç‡§ï ‡§®‡§π‡•Ä‡§Ç üéâ</p>";          
    return;          
  }          

  const grouped={};          
  for(const t of filtered){          
    // Check if task object is valid (must have a date property)
    if (t.date) {
        if(!grouped[t.date]) grouped[t.date]=[];          
        grouped[t.date].push(t);          
    }
  }          

  const dates=Object.keys(grouped).sort((a,b)=>b.localeCompare(a));          

  for(const date of dates){          
    // Grouping is always expanded in read-only mode for simplicity
    const collapsed = false; 

    const groupDiv=document.createElement("div");          
    groupDiv.className="date-group";          

    groupDiv.innerHTML=`          
      <div class="date-heading ${collapsed?"collapsed":""}">          
        <span>${date}</span>          
        </div>          

      <div id="group-${date}" class="group-tasks ${collapsed?"hidden":""}">          
        ${grouped[date].map(t=>`          
          <div class="task-item ${t.completed?"completed":""}">          
            <div class="task-body">          
              <div class="task-text">‚Ä¢ ${t.text}</div>          
              <div class="task-note">üìù ${t.note ? t.note : "<i>‡§ï‡•ã‡§à ‡§®‡•ã‡§ü ‡§®‡§π‡•Ä‡§Ç</i>"}</div>          
            </div>          
          </div>          
        `).join("")}          
      </div>          
    `;          

    container.appendChild(groupDiv);          
  }          
}          

/* -------------------------          
    INIT          
-------------------------- */          
// Start loading data on page load
loadTasksFromLocalFile();
</script>          

</body>          
</html>
